<!DOCTYPE html>
<html>
<head>
  <title>Electricity Game</title>
</head>
<body>
  <h1>Join Game</h1>
  <input id="gameId" placeholder="Game ID"><br>
  <input id="player" placeholder="Your Name"><br>
  <button onclick="joinGame()">Join</button>

  <h2>Your Generator: <span id="generator">-</span></h2>
  <input id="bid" placeholder="Enter Bid">
  <button onclick="submitBid()">Submit Bid</button>

  <h2>Game State</h2>
  <pre id="state"></pre>

  <script>
    let gameId = "";
    let player = "";
    let socket;

    async function joinGame() {
      gameId = document.getElementById("gameId").value;
      player = document.getElementById("player").value;

      const res = await fetch(`http://localhost:8000/join?game_id=${gameId}&player=${player}`, { method: "POST" });
      const data = await res.json();

      document.getElementById("generator").textContent = data.generator;

      socket = new WebSocket(`ws://localhost:8000/ws/${gameId}/${player}`);
      socket.onmessage = event => {
        document.getElementById("state").textContent = event.data;
      };
    }

    async function submitBid() {
      const amount = parseFloat(document.getElementById("bid").value);
      await fetch("http://localhost:8000/submit_bid", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ game_id: gameId, player, amount })
      });
    }
  </script>
</body>
</html>
